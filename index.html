<!doctype html>

<html>
  <head>
  	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
  	<title>David's Testing App</title>
    <script src='firebase.js'></script>
    <script src="jquery-1.11.1.min.js"></script>  
	<link rel="stylesheet" href="bootstrap.min.css">
	<style>
		input {
			margin-bottom: 10px;
		}
	</style>
  
  </head>
  <body>
  	<div class="container">
  	<h1>David's App</h1>
    <div id='messagesDiv'></div>
    <input class="form-control" type='text' id='nameInput' placeholder='Name'>
    <input class="form-control" type='text' id='messageInput' placeholder='Message'>
    <script>

    var myDataRef = new Firebase('https://incandescent-fire-1261.firebaseIO.com/');

	$('#messageInput').keypress(function (e) {
        if (e.keyCode == 13) {
          var name = $('#nameInput').val();
          var text = $('#messageInput').val();
			myDataRef.push({name: name, text: text});
          $('#messageInput').val('');
        }
      });

		myDataRef.on('child_added', function(snapshot) {
			var message = snapshot.val();
	  		displayChatMessage(message.name, message.text);
		});

      function displayChatMessage(name, text) {
        $('<div/>').text(text).prepend($('<em/>').text(name+': ')).appendTo($('#messagesDiv'));

        $('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
      };

    </script>
    </div>
  </body>
</html>